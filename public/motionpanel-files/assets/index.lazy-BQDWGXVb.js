import{c as x,r as p,j as e,H as o,J as u}from"./app-DS4oLb9Z.js";import{u as y,a as m,R as b,b as h,E as R,L as w,c as E,J as g}from"./job-view-klGDzP4Q.js";import{P as J,c as P}from"./page-header-DWM4_-4Y.js";const L=x("/jobs/failed/")({component:v});function v(){var i,c,l,d;const[a,f]=p.useState(null),t=y({queryKey:["failed-jobs"],queryFn:async()=>(await fetch(`/api${o}/jobs/failed`)).json()}),r=m({mutationFn:async s=>(await fetch(`/api${o}/jobs/failed/${s}`,{method:"DELETE"})).json(),onSuccess:()=>{t.refetch(),u("Job deleted successfully")}}),n=m({mutationFn:async s=>(await fetch(`/api${o}/jobs/failed/${s}/retry`,{method:"POST"})).json(),onSuccess:()=>{t.refetch(),u("Job retried successfully")}});return e.jsx("div",{className:"w-full",children:e.jsxs(b,{direction:"horizontal",children:[e.jsxs(h,{children:[e.jsx(J,{children:e.jsx("h1",{className:"font-medium",children:"Failed Jobs"})}),e.jsxs("div",{className:"flex flex-col space-y-2 p-4",children:[t.isLoading&&e.jsx("div",{children:"Loading..."}),t.isError&&e.jsxs("div",{children:["Error: ",t.error.message]}),t.isSuccess&&((c=(i=t.data)==null?void 0:i.data)==null?void 0:c.length)===0&&e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(R,{children:e.jsx("div",{className:"text-lg font-extralight",children:"Congratulations, no failed jobs!"})})}),t.isSuccess&&((d=(l=t.data)==null?void 0:l.data)==null?void 0:d.map(s=>e.jsx(w,{job:s,className:P((a==null?void 0:a.id)===s.id?"bg-zinc-100":void 0,"border","border-zinc-200","rounded-sm"),onDelete:()=>r.mutate(s.id),onRetry:()=>n.mutate(s.id),showRetryButton:!0,showDeleteButton:!0,showFailedAt:!0,onItemClick:()=>f(s)},s.id)))]})]}),e.jsx(E,{}),e.jsx(h,{children:a&&e.jsx(g,{job:a,showRetryButton:!0,showFailedAt:!0,showDeleteButton:!a.reserved_at,onRetry:()=>n.mutate(a.id),onDelete:()=>r.mutate(a.id)})})]})})}export{L as Route};
